<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ZAD OMNI | Ultimate Dashboard 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root { 
            --primary: #059669; --primary-dark: #047857; --dark: #064e3b; 
            --bg: #f0fdf4; --text: #111827; --accent: #f59e0b;
            --success: #10b981; --warning: #f59e0b; --danger: #ef4444; --info: #3b82f6;
            --border: #e5e7eb; --glass: rgba(255, 255, 255, 0.95);
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Cairo', sans-serif; }
        body { background: linear-gradient(135deg, #f0fdf4 0%, #ecfeff 100%); color: var(--text); min-height: 100vh; overflow-x: hidden; }

        /* --- Admin Bar --- */
        .admin-bar { 
            background: linear-gradient(135deg, var(--dark) 0%, var(--primary) 100%); 
            color: white; padding: 15px 40px; display: flex; justify-content: space-between; align-items: center; 
            position: sticky; top: 0; z-index: 1000; box-shadow: 0 8px 32px rgba(0,0,0,0.15); 
        }
        .logo-text { font-weight: 900; font-size: 24px; letter-spacing: 1px; background: linear-gradient(45deg, #fff, #a7f3d0); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .dynamic-actions { display: flex; gap: 10px; }
        .action-btn { 
            background: rgba(255,255,255,0.15); border: 1px solid rgba(255,255,255,0.3); color: white; 
            padding: 8px 20px; border-radius: 10px; cursor: pointer; font-weight: 600; transition: 0.3s; font-size: 13px;
        }
        .action-btn:hover { background: white; color: var(--primary); transform: translateY(-2px); }

        /* --- Layout --- */
        .container { max-width: 1300px; margin: 30px auto; padding: 0 20px; }
        
        /* Dashboard Grid */
        .dash-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; }
        .card { 
            background: var(--glass); padding: 30px; border-radius: 24px; border: 1px solid var(--border); 
            cursor: pointer; transition: 0.4s; position: relative; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.03);
        }
        .card:hover { transform: translateY(-10px); border-color: var(--primary); box-shadow: 0 20px 40px rgba(5, 150, 105, 0.15); }
        .card i { font-size: 40px; display: block; margin-bottom: 15px; color: var(--primary); }
        .card h3 { font-weight: 800; color: var(--dark); font-size: 1.4rem; }
        .card p { color: #64748b; font-size: 0.9rem; margin-top: 5px; }

        /* --- Pages --- */
        .page { display: none; background: var(--glass); padding: 40px; border-radius: 30px; box-shadow: 0 15px 50px rgba(0,0,0,0.05); animation: slideUp 0.4s ease; min-height: 600px; position: relative; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        
        .page-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 2px solid #f1f5f9; padding-bottom: 20px; }
        .page-title { font-weight: 900; font-size: 2rem; color: var(--dark); }
        .back-btn { background: #f1f5f9; color: var(--text); border: none; padding: 10px 25px; border-radius: 12px; font-weight: 700; cursor: pointer; transition: 0.3s; }
        .back-btn:hover { background: var(--dark); color: white; }

        /* --- Forms --- */
        .form-box { background: #f8fafc; padding: 25px; border-radius: 20px; border: 1px solid #e2e8f0; margin-bottom: 25px; display: none; animation: fadeIn 0.3s; }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: 700; color: #475569; font-size: 0.9rem; }
        input, select, textarea { width: 100%; padding: 14px; border: 2px solid #e2e8f0; border-radius: 14px; font-size: 15px; outline: none; transition: 0.3s; background: white; }
        input:focus { border-color: var(--primary); box-shadow: 0 0 0 4px rgba(5,150,105,0.1); }
        .btn-main { background: var(--primary); color: white; border: none; padding: 15px; border-radius: 14px; width: 100%; font-weight: 800; cursor: pointer; font-size: 16px; margin-top: 15px; transition: 0.3s; }
        .btn-main:hover { background: var(--primary-dark); transform: scale(1.02); }

        /* --- Tables --- */
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { text-align: right; padding: 15px; background: #f1f5f9; color: var(--dark); font-weight: 800; border-radius: 8px; }
        td { padding: 15px; border-bottom: 1px solid #f1f5f9; font-weight: 600; color: #334155; }
        
        /* --- Badges & Heatmap --- */
        .badge { padding: 5px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 800; display: inline-block; }
        .badge.gold { background: linear-gradient(45deg, #fbbf24, #d97706); color: white; }
        .badge.silver { background: linear-gradient(45deg, #94a3b8, #475569); color: white; }
        .badge.danger { background: #fee2e2; color: #dc2626; }
        
        /* --- Report Style --- */
        .report-out { border: 4px solid var(--primary); padding: 40px; border-radius: 30px; background: white; margin-top: 30px; position: relative; transition: 0.5s; }
        .report-out.excellent { background: linear-gradient(135deg, #f0fdf4, #ffffff); border-color: var(--success); } /* Ø£Ø®Ø¶Ø± */
        .report-out.shaky { background: linear-gradient(135deg, #fffbeb, #ffffff); border-color: var(--warning); } /* Ø£ØµÙØ± */
        .report-out.freeze { background: linear-gradient(135deg, #f3f4f6, #ffffff); border-color: #9ca3af; } /* Ø±Ù…Ø§Ø¯ÙŠ */

        .section-header { background: #f1f5f9; color: var(--dark); padding: 10px 15px; border-radius: 10px; font-weight: 800; margin: 20px 0 10px; }

        /* --- Modal (Password) --- */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); backdrop-filter: blur(5px); z-index: 2000; align-items: center; justify-content: center; }
        .modal-content { background: white; padding: 40px; border-radius: 25px; width: 90%; max-width: 400px; text-align: center; }
    </style>
</head>
<body>

<div class="admin-bar">
    <div style="display:flex; align-items:center; gap:10px">
        <span class="logo-text">ZAD OMNI</span>
        <span style="font-size:11px; opacity:0.8; font-weight:600; border:1px solid rgba(255,255,255,0.3); padding:2px 8px; border-radius:10px;">ULTIMATE v4.0</span>
    </div>
    <div id="dynamic-nav" class="dynamic-actions">
        </div>
</div>

<div class="container">
    
    <div id="home">
        <div style="margin-bottom:30px">
            <h1 style="font-weight:900; color:var(--dark); font-size:2.5rem">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø´Ø±ÙˆÙ‚ ğŸ‘‹</h1>
            <p style="color:#64748b">Ø¥Ù„ÙŠÙƒÙ Ù†Ø¸Ø±Ø© Ø´Ø§Ù…Ù„Ø© Ø¹Ù„Ù‰ Ø£Ø¯Ø§Ø¡ ÙØ±ÙŠÙ‚ Ø²Ø§Ø¯ - Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ´ØºÙŠÙ„ 2026</p>
        </div>
        
        <div class="dash-grid">
            <div class="card" onclick="omni.nav('vols')"><i>ğŸ‘¥</i><h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</h3><p>Ø§Ù„Ù…ØªØ·ÙˆØ¹ÙŠÙ†ØŒ Ø§Ù„Ø£Ø¹Ù…Ø§Ø±ØŒ Ø§Ù„Ù€ 360 Card</p></div>
            <div class="card" onclick="omni.nav('eval')"><i>ğŸš€</i><h3>Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø°ÙƒÙŠ</h3><p>ØªÙ‚Ø§Ø±ÙŠØ± Ù…Ù„ÙˆÙ†Ø©ØŒ AI Insights</p></div>
            <div class="card" onclick="omni.nav('heatmap')"><i>ğŸ”¥</i><h3>Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø­Ø±Ø§Ø±ÙŠØ©</h3><p>ÙƒØ´Ù Ù†Ù‚Ø§Ø· Ø¶Ø¹Ù Ø§Ù„ÙØ±ÙŠÙ‚</p></div>
            <div class="card" onclick="omni.nav('criteria')"><i>ğŸ“</i><h3>Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ±</h3><p>Ø«Ø§Ø¨ØªØ© / Ù…ØªØºÙŠØ±Ø©</p></div>
            <div class="card" onclick="omni.nav('vault')"><i>ğŸ’¡</i><h3>Ø®Ø²Ù†Ø© Ø§Ù„Ø£ÙÙƒØ§Ø±</h3><p>Creativity Vault</p></div>
            <div class="card" onclick="omni.nav('admins')"><i>ğŸ”‘</i><h3>Ø§Ù„Ù…ÙÙ‚ÙŠÙ…ÙŠÙ†</h3><p>Super Admin Access</p></div>
            <div class="card" onclick="omni.nav('settings')"><i>ğŸ”’</i><h3>Ø§Ù„Ø£Ù…Ø§Ù†</h3><p>ØªØºÙŠÙŠØ± Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯</p></div>
        </div>
    </div>

    <div id="page-vols" class="page">
        <div class="page-header"><h2 class="page-title">Ø¹Ø§Ø¦Ù„Ø© Ø²Ø§Ø¯ (The 360 View)</h2><button class="back-btn" onclick="omni.nav('home')">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button></div>
        
        <div id="form-vols" class="form-box">
            <div class="form-grid">
                <div><label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label><input id="v-name"></div>
                <div><label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</label><input type="date" id="v-dob" onchange="omni.calcAge(this.value)"></div>
            </div>
            <div class="form-grid">
                <div><label>Ø§Ù„Ø¹Ù…Ø± (Ù…Ø­Ø³ÙˆØ¨ Ø¢Ù„ÙŠØ§Ù‹)</label><input id="v-age" disabled style="background:#f1f5f9"></div>
                <div><label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…</label><input type="date" id="v-join"></div>
            </div>
            <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø³Ø±ÙŠØ© (Ù„Ù„Ù…Ø´Ø±ÙÙŠÙ† ÙÙ‚Ø·)</label><textarea id="v-note"></textarea>
            <button class="btn-main" onclick="omni.addVol()">+ Ø¥Ø¶Ø§ÙØ© Ù„Ù„ÙƒØ§Ø¯Ø±</button>
        </div>

        <div id="v-list-render"></div>
    </div>

    <div id="page-criteria" class="page">
        <div class="page-header"><h2 class="page-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ± (KPIs)</h2><button class="back-btn" onclick="omni.nav('home')">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button></div>
        
        <div id="form-criteria" class="form-box">
            <div class="form-grid">
                <div><label>Ø§Ø³Ù… Ø§Ù„Ù…Ø¹ÙŠØ§Ø±</label><input id="c-name"></div>
                <div><label>Ù†ÙˆØ¹ Ø§Ù„Ù†Ø´Ø§Ø·</label>
                    <select id="c-type">
                        <option value="fixed">Ø£Ù†Ø´Ø·Ø© Ø«Ø§Ø¨ØªØ© (Fixed)</option>
                        <option value="variable">Ø£Ù†Ø´Ø·Ø© Ù…ØªØºÙŠØ±Ø© (Variable)</option>
                    </select>
                </div>
            </div>
            <label>Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„Ù‚ØµÙˆÙ‰ (Max Score)</label><input type="number" id="c-max" value="10">
            <button class="btn-main" onclick="omni.addCrit()">Ø­ÙØ¸ Ø§Ù„Ù…Ø¹ÙŠØ§Ø±</button>
        </div>
        
        <div id="c-list-render"></div>
    </div>

    <div id="page-eval" class="page">
        <div class="page-header"><h2 class="page-title">Ø±Ø§Ø¯Ø§Ø± Ø§Ù„Ø£Ø¯Ø§Ø¡ (AI Evaluation)</h2><button class="back-btn" onclick="omni.nav('home')">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button></div>
        
        <div style="background:#fff; padding:20px; border-radius:15px; border:2px solid var(--primary); margin-bottom:20px">
            <label style="font-size:1.1rem; color:var(--dark)">Ø§Ø®ØªØ± Ø§Ù„Ù…ØªØ·ÙˆØ¹ Ù„Ù„ØªØ­Ù„ÙŠÙ„:</label>
            <select id="ev-select" style="font-size:1rem; padding:10px"></select>
        </div>

        <div id="eval-form-render"></div> <div style="margin-top:20px; background:#fffbeb; padding:20px; border-radius:15px; border:1px solid #f59e0b;">
            <label>ğŸ’¡ Idea Bank (Ù‡Ù„ Ù„Ø¯ÙŠÙ‡ ÙÙƒØ±Ø© Ø¥Ø¨Ø¯Ø§Ø¹ÙŠØ©ØŸ)</label>
            <textarea id="ev-idea" placeholder="Ø§ÙƒØªØ¨ÙŠ Ø§Ù„ÙÙƒØ±Ø© Ù‡Ù†Ø§ Ù„ÙŠØªÙ… Ø­ÙØ¸Ù‡Ø§ ÙÙŠ Ø®Ø²Ù†Ø© Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ ÙˆØªØ¸Ù‡Ø± ÙÙŠ Ø§Ù„ØªÙ‚Ø±ÙŠØ±"></textarea>
        </div>

        <button class="btn-main" onclick="omni.generateReport()">ğŸ›  ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ÙØ³ÙŠ</button>
        
        <div id="report-area"></div>
    </div>

    <div id="page-heatmap" class="page">
        <div class="page-header"><h2 class="page-title">Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø­Ø±Ø§Ø±ÙŠØ© Ù„Ù„ÙØ±ÙŠÙ‚</h2><button class="back-btn" onclick="omni.nav('home')">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button></div>
        <p style="margin-bottom:20px">Ù‡Ù†Ø§ ÙŠØ¸Ù‡Ø± Ù…ØªÙˆØ³Ø· Ø£Ø¯Ø§Ø¡ Ø§Ù„ÙØ±ÙŠÙ‚ ÙÙŠ ÙƒÙ„ Ù…Ø¹ÙŠØ§Ø± Ù„ÙƒØ´Ù Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ©.</p>
        <div id="heatmap-render" class="dash-grid"></div>
    </div>

    <div id="page-vault" class="page">
        <div class="page-header"><h2 class="page-title">Genius Vault ğŸ’¡</h2><button class="back-btn" onclick="omni.nav('home')">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button></div>
        <div id="vault-render"></div>
    </div>

    <div id="page-admins" class="page">
        <div class="page-header"><h2 class="page-title">Super Admin Access</h2><button class="back-btn" onclick="omni.nav('home')">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button></div>
        
        <div id="form-admins" class="form-box">
            <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ù„Ù…ÙÙ‚ÙŠÙ…</label><input type="email" id="adm-email" placeholder="email@example.com">
            <label>Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©</label>
            <select id="adm-role">
                <option>ØªÙ‚ÙŠÙŠÙ… ÙÙ‚Ø·</option>
                <option>Ø¹Ø±Ø¶ ØªÙ‚Ø§Ø±ÙŠØ± ÙÙ‚Ø·</option>
                <option>Ù…Ø¯ÙŠØ± ÙƒØ§Ù…Ù„ (Full Access)</option>
            </select>
            <button class="btn-main" onclick="omni.addAdmin()">Ù…Ù†Ø­ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©</button>
        </div>
        <div id="adm-list-render"></div>
    </div>

    <div id="page-settings" class="page">
        <div class="page-header"><h2 class="page-title">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†</h2><button class="back-btn" onclick="omni.nav('home')">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button></div>
        <div style="text-align:center; padding:50px">
            <button class="btn-main" style="max-width:300px; background:var(--dark)" onclick="document.getElementById('pwd-modal').style.display='flex'">ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</button>
        </div>
    </div>

</div>

<div id="pwd-modal" class="modal">
    <div class="modal-content">
        <h3>ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</h3>
        <input type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ©" style="margin:10px 0">
        <input type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©" style="margin:10px 0">
        <button class="btn-main" onclick="alert('ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨Ù†Ø¬Ø§Ø­ âœ…'); document.getElementById('pwd-modal').style.display='none'">ØªØ­Ø¯ÙŠØ«</button>
        <button onclick="document.getElementById('pwd-modal').style.display='none'" style="background:none; border:none; color:red; margin-top:10px; cursor:pointer">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
</div>

<script>
    // --- ZAD OMNI BRAIN v4.0 ---
    const omni = {
        data: {
            vols: JSON.parse(localStorage.getItem('zad_vols')) || [],
            crit: JSON.parse(localStorage.getItem('zad_crit')) || [
                {id:1, name:'Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠ', type:'fixed', max:10},
                {id:2, name:'Ø§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„Ø±Ù‚Ù…ÙŠ', type:'variable', max:10}
            ],
            admins: JSON.parse(localStorage.getItem('zad_admins')) || [],
            ideas: JSON.parse(localStorage.getItem('zad_ideas')) || [],
            history: JSON.parse(localStorage.getItem('zad_history')) || [] // Ù„ØªØ®Ø²ÙŠÙ† Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø´Ù‡ÙˆØ± Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ù„Ù„ØªØ±Ù†Ø¯
        },

        init() {
            this.nav('home');
        },

        // --- Navigation Logic (Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø°ÙƒÙŠØ©) ---
        nav(pageId) {
            // Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„ Ø§Ù„ØµÙØ­Ø§Øª
            document.getElementById('home').style.display = 'none';
            document.querySelectorAll('.page').forEach(p => p.style.display = 'none');
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
            if(pageId === 'home') document.getElementById('home').style.display = 'grid';
            else {
                document.getElementById('page-'+pageId).style.display = 'block';
                // ØªØ´ØºÙŠÙ„ ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø§ØµØ© Ø¨ÙƒÙ„ ØµÙØ­Ø©
                if(pageId === 'vols') this.renderVols();
                if(pageId === 'criteria') this.renderCrit();
                if(pageId === 'eval') this.renderEvalPage();
                if(pageId === 'admins') this.renderAdmins();
                if(pageId === 'vault') this.renderVault();
                if(pageId === 'heatmap') this.renderHeatmap();
            }
            this.updateHeader(pageId);
        },

        updateHeader(pageId) {
            const bar = document.getElementById('dynamic-nav');
            bar.innerHTML = ''; // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø­Ø³Ø¨ Ø§Ù„Ø³ÙŠØ§Ù‚
            if(pageId === 'vols') bar.innerHTML = `<button class="action-btn" onclick="omni.toggle('form-vols')">+ Ø¥Ø¶Ø§ÙØ© Ù…ØªØ·ÙˆØ¹</button>`;
            if(pageId === 'criteria') bar.innerHTML = `<button class="action-btn" onclick="omni.toggle('form-criteria')">+ Ø¥Ø¶Ø§ÙØ© Ù…Ø¹ÙŠØ§Ø±</button>`;
            if(pageId === 'admins') bar.innerHTML = `<button class="action-btn" onclick="omni.toggle('form-admins')">+ Ø¥Ø¶Ø§ÙØ© Ù…ÙÙ‚ÙŠÙ…</button>`;
        },

        toggle(id) {
            const el = document.getElementById(id);
            el.style.display = (el.style.display === 'block') ? 'none' : 'block';
        },

        // --- 1. Volunteers Logic & 360 Card ---
        calcAge(dob) {
            if(!dob) return;
            const age = new Date().getFullYear() - new Date(dob).getFullYear();
            document.getElementById('v-age').value = age + " Ø³Ù†Ø©";
        },

        addVol() {
            const name = document.getElementById('v-name').value;
            if(!name) return alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø§Ø³Ù…');
            const vol = {
                id: Date.now(),
                name: name,
                dob: document.getElementById('v-dob').value,
                age: document.getElementById('v-age').value,
                joinDate: document.getElementById('v-join').value,
                note: document.getElementById('v-note').value
            };
            this.data.vols.push(vol);
            this.save();
            this.renderVols();
            this.toggle('form-vols');
            alert('ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù„Ù„ÙƒØ§Ø¯Ø± âœ…');
        },

        renderVols() {
            const list = document.getElementById('v-list-render');
            if(this.data.vols.length === 0) { list.innerHTML = '<p style="text-align:center; color:#999">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ØªØ·ÙˆØ¹ÙŠÙ† Ø­Ø§Ù„ÙŠØ§Ù‹</p>'; return; }
            
            let html = `<table><tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ø¹Ù…Ø±</th><th>Ø§Ù„Ù„Ù‚Ø¨ (Ø§Ù„Ø®Ø¨Ø±Ø©)</th><th>ØªÙ†Ø¨ÙŠÙ‡</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr>`;
            
            this.data.vols.forEach(v => {
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù„Ù‚Ø¨ (360 Logic)
                const months = v.joinDate ? Math.floor((new Date() - new Date(v.joinDate)) / (1000*60*60*24*30)) : 0;
                let rank = "ğŸŒ± Ù…ØªØ·ÙˆØ¹ Ù†Ø§Ø´Ø¦";
                let badgeClass = "silver";
                if(months > 6) { rank = "â­ Ù…ØªØ·ÙˆØ¹ Ø®Ø¨ÙŠØ±"; badgeClass = "gold"; }
                if(months > 12) { rank = "ğŸ’ Ø¹Ù…ÙˆØ¯ Ø²Ø§Ø¯"; badgeClass = "gold"; }

                // Ø±Ø§Ø¯Ø§Ø± Ø§Ù„ØªÙ†Ø¨Ø¤ Ø¨Ø§Ù„Ø§Ù†Ø³Ø­Ø§Ø¨ (Predictive Dropout) - Ù…Ø­Ø§ÙƒØ§Ø©
                // Ù„Ùˆ Ø§Ù„Ù…ØªØ·ÙˆØ¹ Ø¯Ù‡ Ø¯Ø±Ø¬Ø§ØªÙ‡ ÙˆØ­Ø´Ø© Ù…Ø±ØªÙŠÙ† ÙˆØ±Ø§ Ø¨Ø¹Ø¶ (Ù‡Ù†ÙØªØ±Ø¶ Ø´Ø±Ø· Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ù„Ù„ØªØ¬Ø±Ø¨Ø© Ù‡Ù†Ø§)
                let alertIcon = "";
                // Logic can be connected to history later

                html += `
                <tr>
                    <td><b>${v.name}</b></td>
                    <td>${v.age || '--'}</td>
                    <td><span class="badge ${badgeClass}">${rank}</span></td>
                    <td>${alertIcon}</td>
                    <td><button onclick="omni.delVol(${v.id})" style="color:red; background:none; border:none; cursor:pointer">Ø­Ø°Ù</button></td>
                </tr>`;
            });
            list.innerHTML = html + `</table>`;
        },
        delVol(id) { if(confirm('Ø­Ø°Ù Ø§Ù„Ù…ØªØ·ÙˆØ¹ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ')) { this.data.vols = this.data.vols.filter(v=>v.id!==id); this.save(); this.renderVols(); } },

        // --- 2. Criteria Logic (Fixed/Variable) ---
        addCrit() {
            const name = document.getElementById('c-name').value;
            if(!name) return;
            this.data.crit.push({
                id: Date.now(),
                name: name,
                type: document.getElementById('c-type').value,
                max: document.getElementById('c-max').value
            });
            this.save(); this.renderCrit(); this.toggle('form-criteria');
        },
        renderCrit() {
            let html = `<table><tr><th>Ø§Ù„Ù…Ø¹ÙŠØ§Ø±</th><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Max</th><th>Ø­Ø°Ù</th></tr>`;
            this.data.crit.forEach(c => {
                html += `<tr><td>${c.name}</td><td>${c.type==='fixed'?'Ø«Ø§Ø¨ØªØ©':'Ù…ØªØºÙŠØ±Ø©'}</td><td>${c.max}</td><td><button onclick="omni.delCrit(${c.id})" style="color:red;border:none;background:none;cursor:pointer">X</button></td></tr>`;
            });
            document.getElementById('c-list-render').innerHTML = html + `</table>`;
        },
        delCrit(id) { this.data.crit = this.data.crit.filter(c=>c.id!==id); this.save(); this.renderCrit(); },

        // --- 3. Evaluation & AI Reporting Logic -
